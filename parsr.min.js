/**
 *
 * Plugin:
 * @version 1.0.0
 *
 * @author: Joris DANIEL
 * @fileoverview: Parsr allow you to automatically load and instanciate requireJS module by data attribute in DOM
 *
 * Copyright (c) 2016 Joris DANIEL
 * Licensed under the MIT license
 *
 **/
!function(a,b){"use strict";var c=function(b){this.listAllModulesName=[],this.options=a.extend({dataAttribute:"data-modules",modulesToPreserve:[],nameMethodInit:"init",nameMethodDestroy:"destroy",removeAttribute:!0,debug:!0},b||{}),this.start=function(a){this.listAllModulesName=this.parseDOM(),this.listAllModulesNameToDestroy=this.keepPreservedModules(this.listAllModulesName.slice(0));for(var c=0,d=this.listAllModulesName.length;c<d;c++)this.loadModule(this.listAllModulesName[c],c,d,a)},this.destroy=function(a){for(var c=this.listAllModulesNameToDestroy.length,d=c-1;d>=0;d--)this.destroyModule(this.listAllModulesNameToDestroy[d],d,c,a)}};c.prototype.parseDOM=function(){var b=this,c=[];return a("html").find("["+this.options.dataAttribute+"]").each(function(){for(var d=a(this),e=d.attr(b.options.dataAttribute).replace(" ","").split(","),f=e.length,h=null,j=0;j<f;j++)h=e[j],""!==h&&c.indexOf(h)===-1&&c.push(h);b.options.removeAttribute&&a(this).removeAttr(b.options.dataAttribute)}),c},c.prototype.keepPreservedModules=function(a){for(var b=a.length,c=this.options.modulesToPreserve.length,d=b-1;d>=0;d--)for(var e=0;e<c;e++)a[d]===this.options.modulesToPreserve[e]&&a.splice(d,1);return a},c.prototype.loadModule=function(a,b,c,d){var e=this;require([a],function(f){"function"==typeof f[e.options.nameMethodInit]?(f[e.options.nameMethodInit](),e.options.debug&&console.log(a+" :: init")):console.warn('Parsr :: module "'+a+'" has no method '+e.options.nameMethodInit+'(). Please use the same name method on all your modules with "nameMethodInit" option.'),b===c-1&&"function"==typeof d&&d()})},c.prototype.destroyModule=function(a,b,c,d){var e=this;require([a],function(c){"function"==typeof c[e.options.nameMethodDestroy]?(c[e.options.nameMethodDestroy](),e.options.debug&&console.log(a+" :: destroy")):console.warn('Parsr :: module "'+a+'" has no method '+e.options.nameMethodDestroy+'(). Please use the same name method on all your modules with "nameMethodDestroy" option.'),0===b&&"function"==typeof d&&d()})},b.Parsr=c}(jQuery,window);